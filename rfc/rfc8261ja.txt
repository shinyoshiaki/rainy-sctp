









ISSN：2070-1721 Netflix、Inc. R. Jesup WorldGate Communications S. Loreto Ericsson 2017年11月 



SCTPパケットのデータグラムトランスポート層セキュリティ（DTLS）カプセル化 

概要 

ストリーム制御伝送プロトコル（SCTP）は、もともとネットワークプロトコルIPv4またはIPv6上で実行するように定義されたトランスポートプロトコルです. このドキュメントでは、SCTPをデータグラムトランスポート層セキュリティ（DTLS）プロトコルの上で使用する方法を指定します. このドキュメントで説明されているカプセル化方法を使用すると、SCTPはDTLSの下で使用されているプロトコルを認識しません. したがって、明示的なIPアドレスをSCTP制御チャンクで使用することはできません. その結果、DTLSを介して伝送されるSCTPアソシエーションはシングルホームにしかできません. 

このドキュメントは、IETF（Internet Engineering Task Force）の製品です. これは、IETFコミュニティのコンセンサスを表しています. 公開レビューを受け、インターネットエンジニアリングステアリンググループ（IESG）による公開が承認されました. インターネット標準の詳細については、RFC 7841のセクション2を参照してください. 

このドキュメントの現在のステータス、正誤表、およびフィードバックの提供方法に関する情報は、https：//www.rfc-editor.org/info/rfc8261で入手できます.  



著作権表示 

Copyright（c）2017 IETF Trustおよびドキュメントの作成者として識別された人物. 全著作権所有. 

この文書は、BCP 78およびIETF文書に関するIETFトラストの法的規定（https://trustee.ietf.org/license-info）の対象であり、この文書の発行日に有効です. これらのドキュメントは、このドキュメントに関するあなたの権利と制限を説明しているため、注意深く確認してください. このドキュメントから抽出されたコードコンポーネントには、Trust Legal Provisionsのセクション4.eに記載されているSimplified BSD Licenseのテキストが含まれている必要があり、Simplified BSD Licenseに記載されているように保証なしで提供されます. 

目次

   1. 概要 . . . . . . . . . . . . . . . . . . . . . . . . . . ３
   2.規約. . . . . . . . . . . . . . . . . . . . . . . . . ３
   3.カプセル化とカプセル化解除の手順. . . . . . . . . . ３
   4.一般的な考慮事項. . . . . . . . . . . . . . . . . . . 4
   5. DTLSに関する考慮事項. . . . . . . . . . . . . . . . . . . . . 4
   6. SCTPの考慮事項. . . . . . . . . . . . . . . . . . . . . 5
   7. IANAの考慮事項. . . . . . . . . . . . . . . . . . . . . 6
   8.セキュリティに関する考慮事項. . . . . . . . . . . . . . . . . . . 7
   9.参考資料. . . . . . . . . . . . . . . . . . . . . . . . . 7
   謝辞. . . . . . . . . . . . . . . . . . . . . . . . . 10
   著者のアドレス. . . . . . . . . . . . . . . . . . . . . . . 10


1. 概要 

[RFC4960]で定義されているStream Control Transmission Protocol（SCTP）は、ネットワークプロトコルIPv4 [RFC0791]またはIPv6 [RFC8200]の上で実行されるトランスポートプロトコルです. このドキュメントでは、SCTPがDatagram Transport Layer Security（DTLS）プロトコル上でどのように使用されるかを指定します. DTLS 1.0は[RFC4347]で定義されており、このRFCが公開されたときの最新バージョンであるDTLS 1.2は[RFC6347]で定義されています. このカプセル化は、たとえば、ブラウザ間で非SRTPデータを転送するためにWebRTCプロトコルスイート（概要については[RTC-OVERVIEW]を参照）内で使用されます. このスタックのアーキテクチャは[DATA-CHAN]で説明されています. 

                               +----------+
                               |   SCTP   |
                               +----------+
                               |   DTLS   |
                               +----------+
                               | ICE/UDP  |
                               +----------+

                       Figure 1: Basic Stack Diagram

UDPまたはICE / UDPを介したDTPを介したSCTPのこのカプセル化（[RFC5245]を参照）は、機密性、ソース認証、および整合性保護転送に加えて、NATトラバーサルソリューションを提供できます. ICEを使用しても、ネットワーク上で別のパケット形式が使用されるとは限らないことに注意してください. 

[RFC6951]で定義されているUDPポート番号の処理手順はここでは適用されないことに注意してください. このドキュメントで定義されているカプセル化を使用する場合、SCTPはDTLSの下で使用されるプロトコルを認識しません. 

2.規約 

キーワード「MUST」、「MUST NOT」、「REQUIRED」、「SHALL」、「SHALL NOT」、「SHOULD」、「SHOULD NOT」、「RECOMMENDED」、「NOT RECOMMENDED」、「MAY」、「OPTIONALこのドキュメントの「」は、BCP 14 [RFC2119] [RFC8174]で説明されているように解釈されます.  

3.カプセル化とカプセル化解除の手順 

SCTPパケットがDTLS層に提供されると、SCTP共通ヘッダーといくつかのSCTPチャンクで構成される完全なSCTPパケットが、DTLSのアプリケーション層プロトコルのペイロードとして処理されます. DTLS層がアプリケーション層プロトコルのメッセージを含むDTLSレコードを処理すると、ペイロードがSCTP層に渡されます. SCTP層は、SCTP共通ヘッダーの後にいくつかのSCTPチャンクが続くことを期待しています. 

4.一般的な考慮事項 

SCTP over DTLSの実装では、ICMPなしで機能するパス最大伝送ユニット（MTU）の検出方法を実装および使用して、SCTP / DTLSにMTU推定を提供する必要があります. SCTPまたはDTLSでの「パケット化層パスMTU発見」[RFC4821]の実装が推奨されます. 

パスMTU検出は、SCTP over DTLSがデータチャネルに使用される場合にSCTPによって実行されます（[DATA-CHAN]のセクション5を参照）.  

5. DTLSに関する考慮事項 

DTLS実装はDTLS 1.0 [RFC4347]をサポートする必要があり、このRFCが公開されたときのDTLS 1.2 [RFC6347]であるDTLSの最新の公開バージョンをサポートする必要があります（SHOULD）. このドキュメントに改訂がない場合、後者の要件は、RFCとして公開されたDTLSの将来のすべてのバージョンに適用されます. このドキュメントは、DTLSまたはSCTPの改訂によりカプセル化の改訂が必要になった場合にのみ改訂されます. 

SCTPは、パスMTUに基づいてセグメンテーションと再構成を実行します. したがって、DTLSレイヤーは圧縮アルゴリズムを使用してはなりません（MUST NOT）. 

DTLSは、現在のパスMTUよりも大きいメッセージの送信をサポートする必要があります. これにより、IPレベルの断片化されたメッセージが送信される可能性があります. 

パスMTUディスカバリがDTLSレイヤによって実行される場合、[RFC4821]で説明されている方法を使用する必要があります. プローブパケットについては、[RFC6520]で定義されている拡張機能を使用する必要があります. 

パスMTUディスカバリがSCTPレイヤーによって実行され、IPv4がネットワークレイヤープロトコルとして使用されている場合、DTLS実装は、DTLSユーザーが対応するIPv4パケットがDo n't Fragment（DF）ビットセットで送信されることを強制できるようにする必要があります. DFビットを制御できない場合（たとえば、実装の制限のため）、パスMTUの安全な値をSCTPスタックで使用する必要があります. 安全な値が1200バイトを超えないようにすることをお勧めします. [RFC1122]では、エンドホストが最大576バイトの長さの断片化されたIPパケットを再構成できることだけが必要であることに注意してください. 

DTLS実装は、DTLSユーザーが送信されるIPパケットに使用されるDiffServコードポイント（DSCP）を設定できるようにする必要があります（SHOULD）（[RFC2474]を参照）. これには、DTLS実装が値を渡し、下位層がこの値を設定できるようにする必要があります. 下位層がDSCPの設定をサポートしていない場合、DTLSユーザーはプロトコルスタックで使用されるデフォルト値で終了します. 同じSCTPアソシエーションに属するすべてのパケットに使用できるDSCP値は1つだけであることに注意してください. 

SCTPで明示的輻輳通知（ECN）を使用するには、DTLSレイヤーがECNビットを通過し、その下位レイヤーが送受信パケットのアクセスを公開する必要があります（[RFC3168]を参照）. DTLSとその下位層の実装は、このサポートを提供する必要があります. これが不可能な場合（たとえば、実装の制限のため）、SCTPはECNを使用できません. 

6. SCTPに関する考慮事項 

このセクションでは、基本プロトコルの使用法とさまざまなSCTP拡張の適用性について説明します.  

6.1. 基本プロトコル

このドキュメントでは、SCTP [RFC4960]を次の制限付きで使用します. これは、下位層がIPv4およびIPv6ではなくDTLSであり、SCTPがDTLSの下で使用されるIPアドレスまたはトランスポートプロトコルを処理しないことを反映するために必要です.  

o SCTPアソシエーションを設定する前に、DTLS接続を確立する必要があります.  

o複数のSCTPアソシエーションは、単一のDTLS接続を介して多重化される場合があります. SCTPポート番号は、単一のDTLS接続で伝送されるSCTPアソシエーションを多重化および逆多重化するために使用されます. 

o DTLSはアドレス管理を上位層に公開しないため、すべてのSCTPアソシエーションはシングルホームです. したがって、SCTPパラメータpath.max.retransをAssociation.max.retransに設定することをお勧めします. 

o INITおよびINIT-ACKチャンクには、IPv4アドレスまたはIPv6アドレスパラメータを含めてはなりません. INITチャンクには、Supported Address Typesパラメータを含めてはなりません（MUST NOT）. 

o実装はICMPまたはICMPv6パケットの処理に依存してはなりません. これは、SCTPレイヤーがパケットのプレーンテキストのSCTP共通ヘッダーにアクセスできず、ICMPまたはICMPv6パケットの送信がトリガーされたためです. これは特に、SCTPによって実行される場合のパスMTU検出に適用されます. 

o SCTP層が下位層からパス変更について通知を受けた場合、SCTPはパスMTUを再テストして、輻輳状態を初期状態にリセットする必要があります（SHOULD）. [RFC4960]で指定されたウィンドウベースの輻輳制御方法は、輻輳ウィンドウとスロースタートしきい値を初期値にリセットします. 

6.2. パディング拡張

[RFC4821]で指定されているようにSCTPレイヤーがパスMTUディスカバリを実行する場合、[RFC4820]で定義されたパディング拡張がサポートされ、プローブパケット（PADDINGチャンク[RFC4820]にバンドルされたHEARTBEATチャンク）に使用される必要があります.  

6.3. 動的アドレス再構成拡張

[RFC5061]で定義されている動的アドレス再構成拡張が使用される場合、ASCONFチャンクはワイルドカードアドレスのみを使用する必要があります.  

6.4. SCTP認証拡張

[RFC4895]で定義されているSCTP認証拡張機能は、DTLSカプセル化で使用できますが、追加の利点はありません.  

6.5. 部分信頼性拡張

[RFC3758]で定義されている部分的な信頼性は、DTLSカプセル化と組み合わせて使用​​できます. [RFC7496]で定義されているポリシーなど、追加の部分的に信頼できるストリーム制御伝送プロトコル（PR-SCTP）ポリシーを使用することもできます. 

6.6. ストリームリセット拡張

[RFC6525]で定義されているSCTPストリームリセット拡張機能は、DTLSカプセル化で使用できます. SCTPアソシエーションのライフタイム中にSCTPストリームをリセットし、SCTPストリームを追加するために使用されます. 

6.7. 大きなユーザーメッセージのインターリーブ

[RFC4960]で定義されているSCTPは、SCTPレイヤーでフラグメント化して再構成する必要がある大きなユーザーメッセージのインターリーブをサポートしていません. [RFC8260]で定義されたプロトコル拡張は、この制限を克服し、DTLSカプセル化で使用できます. 

7. IANAに関する考慮事項 

このドキュメントでは、IANAアクションは必要ありません.  



8.セキュリティに関する考慮事項 

DTLSのセキュリティに関する考慮事項は、[RFC4347]および[RFC4960]、[RFC3758]、および[RFC6525]のSCTPで指定されています. SCTPとDTLSを組み合わせても、新しいセキュリティ上の考慮事項はありません. 

DTLSはIPアドレスを保証しないため、基になる通信に使用されるIPアドレスをSCTPで処理しないでください.  

ICMPまたはICMPv6メッセージを処理できなくても、セキュリティ上の問題は発生しないことに注意してください. SCTPがIPv4、IPv6、UDPなどのコネクションレス型の下位層で実行される場合、SCTPをサポートしていない他のノードを保護するために、これらのメッセージの処理が必要です. DTLSは接続指向の下位層を提供するため、この種の保護は必要ありません. 

9.リファレンス 

9.1. 規範的な参考文献

[RFC1122] Braden、R. 、編、「インターネットホストの要件-通信層」、STD 3、RFC 1122、DOI 10.17487 / RFC1122、1989年10月、<https://www.rfc-editor.org/info/ rfc1122>.  

[RFC2119] Bradner、S. 、「要件レベルを示すためにRFCで使用するキーワード」、BCP 14、RFC 2119、DOI 10.17487 / RFC2119、1997年3月、<https://www.rfc-editor.org/info/ rfc2119>.  

[RFC4347] Rescorla、E. およびN. Modadugu、「Datagram Transport Layer Security」、RFC 4347、DOI 10.17487 / RFC4347、2006年4月、<https://www.rfc-editor.org/info/rfc4347>.  

[RFC4820] Tuexen、M.、Stewart、R. 、およびP. Lei、「Stream Control Transmission Protocol（SCTP）のパディングチャンクとパラメータ」、RFC 4820、DOI 10.17487 / RFC4820、2007年3月、<https：// www.rfc-editor.org/info/rfc4820>.  

[RFC4821] Mathis、M. およびJ. Heffner、「Packetization Layer Path MTU Discovery」、RFC 4821、DOI 10.17487 / RFC4821、2007年3月、<https://www.rfc-editor.org/info/rfc4821>.  

[RFC4960] Stewart、R.、Ed. 、「Stream Control Transmission Protocol」、RFC 4960、DOI 10.17487 / RFC4960、2007年9月、<https://www.rfc-editor.org/info/rfc4960>.  



[RFC6347] Rescorla、E. およびN. Modadugu、「Datagram Transport Layer Security Version 1.2」、RFC 6347、DOI 10.17487 / RFC6347、2012年1月、<https://www.rfc-editor.org/info/rfc6347>.  

[RFC6520] Seggelmann、R.、Tuexen、M. 、およびM. Williams、「Transport Layer Security（TLS）and Datagram Transport Layer Security（DTLS）Heartbeat Extension」、RFC 6520、DOI 10.17487 / RFC6520、2012年2月、<https ：//www.rfc-editor.org/info/rfc6520>.  

[RFC8174] Leiba、B. 、「RFC 2119キーワードの大文字と小文字のあいまいさ」、BCP 14、RFC 8174、DOI 10.17487 / RFC8174、2017年5月、<https://www.rfc-editor.org/info/ rfc8174>.  

9.2. 参考情報

[DATA-CHAN] Jesup、R.、Loreto、S. 、およびM. Tuexen、「WebRTCデータチャネル」、Work in Progress、draft-ietf-rtcweb-data-channel-13、2015年1月.  

[RFC0791] Postel、J. 、「インターネットプロトコル」、STD 5、RFC 791、DOI 10.17487 / RFC0791、1981年9月、<https://www.rfc-editor.org/info/rfc791>.  

[RFC2474]ニコルズ、K. 、ブレイク、S. 、ベイカー、F. 、およびD.ブラック、「IPv4およびIPv6ヘッダーのDiffServフィールド（DSフィールド）の定義」、RFC 2474、DOI 10.17487 / RFC2474、 1998年12月、<https://www.rfc-editor.org/info/rfc2474>.  

[RFC3168]ラマクリシュナン、K. 、フロイド、S. 、およびD.ブラック、「IPへの明示的輻輳通知（ECN）の追加」、RFC 3168、DOI 10.17487 / RFC3168、2001年9月、<https：// www.  rfc-editor.org/info/rfc3168>.  

[RFC3758] Stewart、R.、Ramalho、M.、Xie、Q.、Tuexen、M. 、およびP. Conrad、「Stream Control Transmission Protocol（SCTP）Partial Reliability Extension」、RFC 3758、DOI 10.17487 / RFC3758、May 2004、<https://www.rfc-editor.org/info/rfc3758>.  

[RFC4895] Tuexen、M.、Stewart、R.、Lei、P. 、およびE. Rescorla、「Authenticated Chunks for the Stream Control Transmission Protocol（SCTP）」、RFC 4895、DOI 10.17487 / RFC4895、2007年8月、<https ：//www.rfc-editor.org/info/rfc4895>.  



[RFC5061] Stewart、R.、Xie、Q.、Tuexen、M.、Maruyama、S. 、およびM. Kozuka、「Stream Control Transmission Protocol（SCTP）Dynamic Address Reconfiguration」、RFC 5061、DOI 10.17487 / RFC5061、9月2007、<https://www.rfc-editor.org/info/rfc5061>.  

[RFC5245] Rosenberg、J. 、「Interactive Connectivity Establishment（ICE）：A Protocol for Network Address Translator（NAT）Traversal for Offer / Answer Protocols」、RFC 5245、DOI 10.17487 / RFC5245、2010年4月、<https：// www .rfc-editor.org / info / rfc5245>.  

[RFC6525] Stewart、R.、Tuexen、M. 、およびP. Lei、「Stream Control Transmission Protocol（SCTP）Stream Reconfiguration」、RFC 6525、DOI 10.17487 / RFC6525、2012年2月、<https：//www.rfc- editor.org/info/rfc6525>.  

[RFC6951] Tuexen、M. およびR. Stewart、「UDP Encapsulation of Stream Control Transmission Protocol（SCTP）Packets for End-Host to End-Host Communication」、RFC 6951、DOI 10.17487 / RFC6951、2013年5月、<https：/ /www.rfc-editor.org/info/rfc6951>.  

[RFC7496] Tuexen、M.、Seggelmann、R.、Stewart、R. 、およびS. Loreto、「Additional Policies for the Partially Reliable Stream Control Transmission Protocol Extension」、RFC 7496、DOI 10.17487 / RFC7496、2015年4月、<https ：//www.rfc-editor.org/info/rfc7496>.  

[RFC8200] Deering、S. およびR. Hinden、「インターネットプロトコル、バージョン6（IPv6）仕様」、STD 86、RFC 8200、DOI 10.17487 / RFC8200、2017年7月、<https://www.rfc-editor.org / info / rfc8200>.  

[RFC8260] Stewart、R.、Tuexen、M.、Loreto、S. 、およびR. Seggelmann、「Stream Scheduler and User Message Interleaving for the Stream Control Transmission Protocol」、RFC 8260、2017年11月.  

[RTC-OVERVIEW] Alvestrand、H. 、「Overview：Real Time Protocols for Browser-based Applications」、Work in Progress、draft-ietf-rtcweb-overview-18、2017年3月.  









謝辞 

著者は、David Black、Benoit Claise、Spencer Dawkins、Francis Dupont、Gorry Fairhurst、Stephen Farrell、Christer Holmberg、Barry Leiba、Eric Rescorla、Tom Taylor、Joe Touch、およびMagnus Westerlundの貴重なコメントに感謝します.  

著者のアドレス 

Michael Tuexenミュンスター応用科学大学Stegerwaldstrasse 39 48565シュタインフルトドイツ 

メール：tuexen@fh-muenster.de 



Randall R. Stewart Netflix、Inc. Chapin、SC 29036アメリカ合衆国 

メール：randall@lakerest.net 



Randell Jesup WorldGate Communications 3800 Horizo​​n Blvd、Suite＃103 Trevose、PA 19053-4947アメリカ合衆国 

電話：+ 1-215-354-5166メール：randell-ietf@jesup.org 



Salvatore Loreto Ericsson Hirsalantie 11 Jorvas 02420フィンランド 

メール：Salvatore.Loreto@ericsson.com 









 
